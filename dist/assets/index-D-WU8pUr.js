const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-B-oSm5mH.js","./index-93B75wMv.css"])))=>i.map(i=>d[i]);
var h=Object.defineProperty;var f=(i,t,e)=>t in i?h(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var u=(i,t,e)=>f(i,typeof t!="symbol"?t+"":t,e);import{_ as m}from"./index-B-oSm5mH.js";import{f as G,B as A,d as H,e as V,b as Z,a as K,c as J,g as W}from"./index-B-oSm5mH.js";class b{constructor(t){u(this,"element");u(this,"config");this.config=t,this.element=this.createElement()}createElement(){const t=document.createElement("button");let n=`btn btn-${this.config.variant||"primary"}`;return this.config.size&&(n+=` btn-${this.config.size}`),this.config.className&&(n+=` ${this.config.className}`),t.className=n,t.textContent=this.config.text,this.config.disabled&&(t.disabled=!0),this.config.style&&(t.style.cssText=this.config.style),this.config.onClick&&t.addEventListener("click",a=>{a.preventDefault(),this.config.onClick()}),t}getElement(){return this.element}setText(t){this.config.text=t,this.element.textContent=t}setDisabled(t){this.config.disabled=t,this.element.disabled=t}setVariant(t){const e=this.config.variant||"primary";this.element.classList.remove(`btn-${e}`),this.config.variant=t||"primary",this.element.classList.add(`btn-${this.config.variant}`)}setOnClick(t){var n;const e=this.element.cloneNode(!0);(n=this.element.parentNode)==null||n.replaceChild(e,this.element),this.element=e,this.config.onClick=t,this.element.addEventListener("click",a=>{a.preventDefault(),t()})}remove(){this.element.parentNode&&this.element.parentNode.removeChild(this.element)}}class y{constructor(t){u(this,"cards",new Map);u(this,"container",null);this.container=t||this.createContainer()}createContainer(){const t=document.createElement("div");return t.className="card-container flex flex-wrap gap-4 p-4",t}createCard(t){return this.cards.set(t.id,t),this.renderCard(t)}renderCard(t){const e=document.createElement("div");e.className=`card bg-base-100 shadow-xl ${t.className||""}`,e.setAttribute("data-card-id",t.id);const n=document.createElement("div");n.className="card-body";const a=document.createElement("h2");if(a.className="card-title",a.textContent=t.title,t.subtitle){const s=document.createElement("p");s.className="text-sm text-gray-500 mb-2",s.textContent=t.subtitle,n.appendChild(s)}n.appendChild(a);const o=document.createElement("div");if(o.className="card-content",o.innerHTML=t.content,n.appendChild(o),t.actions&&t.actions.length>0){const s=document.createElement("div");s.className="card-actions justify-end mt-4",t.actions.forEach(r=>{const l=document.createElement("button");l.className=`btn btn-sm btn-${r.variant||"primary"}`,l.textContent=r.text,l.setAttribute("data-action-id",r.id),l.disabled=r.disabled||!1,l.addEventListener("click",d=>{d.preventDefault(),d.stopPropagation(),r.disabled||r.onClick()}),s.appendChild(l)}),n.appendChild(s)}if(t.status&&t.status!=="default"){const s=document.createElement("div");s.className=`status-indicator status-${t.status}`;const r=this.getStatusIcon(t.status);s.innerHTML=r,e.appendChild(s)}return e.appendChild(n),e}getStatusIcon(t){switch(t){case"success":return'<span class="status-icon success">✓</span>';case"warning":return'<span class="status-icon warning">⚠</span>';case"error":return'<span class="status-icon error">✗</span>';default:return""}}addCardToContainer(t){if(!this.container)return;const e=this.createCard(t);this.container.appendChild(e)}removeCard(t){var n;const e=(n=this.container)==null?void 0:n.querySelector(`[data-card-id="${t}"]`);e&&(e.remove(),this.cards.delete(t))}updateCard(t,e){var s;const n=this.cards.get(t);if(!n)return;const a={...n,...e};this.cards.set(t,a);const o=(s=this.container)==null?void 0:s.querySelector(`[data-card-id="${t}"]`);if(o){const r=this.createCard(a);o.replaceWith(r)}}setContainer(t){this.container=t}getCards(){return Array.from(this.cards.values())}clearCards(){this.container&&(this.container.innerHTML=""),this.cards.clear()}}class g{constructor(){u(this,"backdrop");u(this,"contentBox");u(this,"onCloseCallback",null);u(this,"onSubmitCallback",null);this.backdrop=document.createElement("div"),this.backdrop.style.position="fixed",this.backdrop.style.top="0",this.backdrop.style.left="0",this.backdrop.style.width="100%",this.backdrop.style.height="100%",this.backdrop.style.backgroundColor="rgba(0, 0, 0, 0.8)",this.backdrop.style.display="none",this.backdrop.style.zIndex="1000",this.backdrop.addEventListener("click",()=>this.close()),this.contentBox=document.createElement("div"),this.contentBox.style.position="absolute",this.contentBox.style.top="50%",this.contentBox.style.left="50%",this.contentBox.style.transform="translate(-50%, -50%)",this.contentBox.style.backgroundColor="#1e1e1e",this.contentBox.style.color="#ffffff",this.contentBox.style.padding="20px",this.contentBox.style.borderRadius="8px",this.contentBox.style.boxShadow="0 4px 6px rgba(0, 0, 0, 0.3)",this.contentBox.addEventListener("click",t=>t.stopPropagation()),this.backdrop.appendChild(this.contentBox),document.body.appendChild(this.backdrop)}open(t,e,n){this.contentBox.innerHTML="",t.forEach(r=>{let l;switch(r.type){case"heading":l=document.createElement("h2"),l.textContent=r.text||"";break;case"input":const d=document.createElement("input");d.id=r.id||"",d.type=r.inputType||"text",d.placeholder=r.placeholder||"",d.className=r.class||"",d.style.cssText=r.style||"",r.disabled&&(d.disabled=!0),l=d;break;default:console.warn(`Unsupported element type: ${r.type}`);return}this.contentBox.appendChild(l)});const a=document.createElement("div");a.style.textAlign="right";const o=document.createElement("button");o.id="dialog-submit",o.textContent="Submit",o.className="btn btn-primary",o.style.marginRight="10px",o.addEventListener("click",()=>{const r=this.collectData();this.onSubmitCallback&&this.onSubmitCallback(r),this.close()});const s=document.createElement("button");s.id="dialog-cancel",s.textContent="Cancel",s.className="btn btn-secondary",s.addEventListener("click",()=>this.close()),a.appendChild(o),a.appendChild(s),this.contentBox.appendChild(a),this.onSubmitCallback=e,this.onCloseCallback=n||null,this.backdrop.style.display="block"}close(){this.backdrop.style.display="none",this.onCloseCallback&&this.onCloseCallback()}collectData(){const t=this.contentBox.querySelectorAll("input"),e={};return t.forEach(n=>{n.id&&(e[n.id]=n.value)}),e}}async function E(i,t){try{const{exec:e}=require("child_process"),{promisify:n}=require("util"),a=n(e),o=require("fs");o.existsSync(t)||o.mkdirSync(t,{recursive:!0});const s=process.platform;let r;if(s==="win32"){const l=i.replace(/\\/g,"\\\\"),d=t.replace(/\\/g,"\\\\");r=`powershell -Command "Expand-Archive -Path '${l}' -DestinationPath '${d}' -Force"`}else if(s==="darwin")r=`unzip -o "${i}" -d "${t}"`;else throw new Error(`Unsupported platform: ${s}`);return console.log(`Extracting zip: ${r}`),await a(r),!0}catch(e){return console.error("Zip extraction failed:",e),!1}}async function C(i){try{const{exec:t}=require("child_process"),{promisify:e}=require("util"),n=e(t),a=process.platform;let o;if(a==="win32")o=`powershell -Command "Add-Type -AssemblyName System.IO.Compression.FileSystem; [System.IO.Compression.ZipFile]::OpenRead('${i.replace(/\\/g,"\\\\")}').Entries | Select-Object -ExpandProperty FullName"`;else if(a==="darwin")o=`unzip -l "${i}" | grep -E '^[[:space:]]*[0-9]+' | awk '{print $NF}'`;else throw new Error(`Unsupported platform: ${a}`);const{stdout:s}=await n(o);return a==="win32"?s.trim().split(`
`).filter(r=>r.trim()):s.trim().split(`
`).filter(r=>r.trim())}catch(t){return console.error("Failed to list zip contents:",t),[]}}async function w(i,t,e=null,n={}){const a=require("fs"),o=require("path");try{const s=await window.eagle.os.tmpdir(),r=o.join(s,`${i}.${t}`),l=await window.eagle.folder.getSelected();if(l&&l.length>0){const d=l[0];n.folders=[d.id]}return await a.promises.writeFile(r,e||""),n.name=`${i}.${t}`,await window.eagle.item.addFromPath(r,n),!0}catch(s){return console.error("Failed to create file in Eagle:",s),!1}}function x(i,t=2){if(i===0)return"0 Bytes";const e=1024,n=t<0?0:t,a=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],o=Math.floor(Math.log(i)/Math.log(e));return parseFloat((i/Math.pow(e,o)).toFixed(n))+" "+a[o]}const v=Object.freeze(Object.defineProperty({__proto__:null,createFile:w,extractZip:E,formatBytes:x,listZipContents:C},Symbol.toStringTag,{value:"Module"}));function T(i,t,e){const n=document.createElement(i);return t&&(n.className=t),e&&(n.textContent=e),n}function P(i,t){const e=document.createElement("style");t&&(e.id=t),e.textContent=i,document.head.appendChild(e)}function k(i){const t=document.getElementById(i);t&&t.remove()}function S(i,t=5e3){return new Promise((e,n)=>{const a=document.querySelector(i);if(a){e(a);return}const o=new MutationObserver(()=>{const s=document.querySelector(i);s&&(o.disconnect(),e(s))});o.observe(document.body,{childList:!0,subtree:!0}),setTimeout(()=>{o.disconnect(),n(new Error(`Element ${i} not found within ${t}ms`))},t)})}function B(i){const t=document.createElement("script");t.textContent=i,document.head.appendChild(t),t.remove()}function _(i){if(navigator.clipboard)return navigator.clipboard.writeText(i);{const t=document.createElement("textarea");return t.value=i,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),Promise.resolve()}}function O(i){const t=document.createElement("div");return t.textContent=i,t.innerHTML}const R=Object.freeze(Object.defineProperty({__proto__:null,addStylesheet:P,copyToClipboard:_,createElement:T,injectScript:B,removeStylesheet:k,sanitizeHtml:O,waitForElement:S},Symbol.toStringTag,{value:"Module"}));function q(i,t){let e;return(...n)=>{clearTimeout(e),e=setTimeout(()=>i(...n),t)}}function $(i,t){let e;return(...n)=>{e||(i(...n),e=!0,setTimeout(()=>e=!1,t))}}function N(i="plugin"){return`${i}-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}function D(i){try{return new URL(i),!0}catch{return!1}}const L=Object.freeze(Object.defineProperty({__proto__:null,debounce:q,generateId:N,isValidUrl:D,throttle:$},Symbol.toStringTag,{value:"Module"})),c=class c{static async _internalGetToken(){if(c.token)return c.token;try{const t=await fetch("http://localhost:41595/api/application/info");if(!t)throw new Error("No response from Eagle");const n=(await t.json()).data.preferences.developer.apiToken;if(n)return c.token=n,n}catch(t){console.error(t)}return null}static async _internalRequest(t,e,n=null,a=null){const o=await c._internalGetToken();if(!o)throw new Error("No token found");let s=`http://localhost:41595/api/${t}?token=${o}`;a&&(a=Object.fromEntries(Object.entries(a).filter(([,r])=>r!==null)),s+="&"+Object.entries(a).map(([r,l])=>`${r}=${l}`).join("&")),e==="POST"&&n&&(n=Object.fromEntries(Object.entries(n).filter(([,r])=>r!==null)));try{return(await(await fetch(s,e==="POST"?{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}:void 0)).json()).data}catch(r){throw console.error("Request failed:",r),r}}};u(c,"token",null),u(c,"application",class{static info(){return c._internalRequest("application/info","GET")}}),u(c,"folder",class{static create(t,e=null){return c._internalRequest("folder/create","POST",{folderName:t,parent:e})}static rename(t,e){return c._internalRequest("folder/rename","POST",{folderId:t,newName:e})}static update(t){return c._internalRequest("folder/update","POST",t)}static list(){return c._internalRequest("folder/list","GET")}static listRecent(){return c._internalRequest("folder/listRecent","GET")}}),u(c,"library",class{static info(){return c._internalRequest("library/info","GET")}static history(){return c._internalRequest("library/history","GET")}static switch(t){return c._internalRequest("library/switch","POST",{libraryPath:t})}static icon(t){return c._internalRequest("library/icon","GET",null,{libraryPath:t})}}),u(c,"item",class{static update(t){return c._internalRequest("item/update","POST",{id:t.itemId,tags:t.tags,annotation:t.annotation,url:t.url,star:t.star})}static refreshThumbnail(t){return c._internalRequest("item/refreshThumbnail","POST",{id:t})}static refreshPalette(t){return c._internalRequest("item/refreshPalette","POST",{id:t})}static moveToTrash(t){return c._internalRequest("item/moveToTrash","POST",{itemIds:t})}static list(t={}){return c._internalRequest("item/list","GET",null,t)}static getThumbnail(t){return c._internalRequest("item/thumbnail","GET",null,{id:t})}static getInfo(t){return c._internalRequest("item/info","GET",null,{id:t})}static addBookmark(t){return c._internalRequest("item/addBookmark","POST",t)}static addFromUrl(t){return c._internalRequest("item/addFromUrl","POST",t)}static addFromPath(t){return c._internalRequest("item/addFromPath","POST",t)}static addFromURLs(t){return c._internalRequest("item/addFromURLs","POST",t)}});let p=c;const j=Object.freeze(Object.defineProperty({__proto__:null,default:p},Symbol.toStringTag,{value:"Module"}));async function I(i,t,e){const n=await m(()=>Promise.resolve().then(()=>j),void 0,import.meta.url),a=await m(()=>Promise.resolve().then(()=>v),void 0,import.meta.url),o=await m(()=>import("./index-B-oSm5mH.js").then(l=>l.p),__vite__mapDeps([0,1]),import.meta.url),s=await m(()=>Promise.resolve().then(()=>R),void 0,import.meta.url),r=await m(()=>Promise.resolve().then(()=>L),void 0,import.meta.url);return{storage:i,container:t,pluginId:e,visual:{Button:b,CardManager:y,Dialog:g},utils:{files:{createFile:a.createFile,extractZip:a.extractZip,listZipContents:a.listZipContents,formatBytes:a.formatBytes},paths:{getUserHomeDirectory:o.getUserHomeDirectory,getExtensionsPath:o.getExtensionsPath,getDownloadPath:o.getDownloadPath,getPowerEagleBasePath:o.getPowerEagleBasePath,ensurePowerEagleDirectories:o.ensurePowerEagleDirectories},dom:{createElement:s.createElement,addStylesheet:s.addStylesheet,removeStylesheet:s.removeStylesheet,waitForElement:s.waitForElement,injectScript:s.injectScript,copyToClipboard:s.copyToClipboard,sanitizeHtml:s.sanitizeHtml},common:{debounce:r.debounce,throttle:r.throttle,generateId:r.generateId,isValidUrl:r.isValidUrl}},webapi:n.default}}export{G as BUILT_IN_PLUGINS,A as BaseManager,b as Button,y as CardManager,g as Dialog,P as addStylesheet,_ as copyToClipboard,H as createDebugLogger,T as createElement,w as createFile,I as createPowerSDKContext,q as debounce,V as ensurePowerEagleDirectories,E as extractZip,x as formatBytes,N as generateId,Z as getDownloadPath,K as getExtensionsPath,J as getPowerEagleBasePath,W as getUserHomeDirectory,B as injectScript,D as isValidUrl,C as listZipContents,k as removeStylesheet,O as sanitizeHtml,$ as throttle,S as waitForElement,p as webapi};
